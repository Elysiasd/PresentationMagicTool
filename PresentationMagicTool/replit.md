# 演示神器 (PresentationMagicTool)

一个专业的演示工具网页应用，支持文件导入、打字机效果演示和多种界面风格。

## 项目概述

这是华中科技大学计算机学院软件工程项目，用于提高演示效率的在线工具。

### 技术栈
- 前端：HTML5, CSS3, JavaScript (ES6+)
- 代码高亮：Prism.js
- 后端：Python 3 (简单 HTTP 服务器)
- 数据存储：localStorage (浏览器本地存储)

## 核心功能

### 原有功能
1. **文件导入**
   - 支持多种文件格式：.txt, .md, .js, .py, .cpp, .html, .css, .json 等
   - 拖拽导入支持
   - 文件预览

2. **双界面风格**
   - Word风格：类似文档编辑器的简洁界面
   - VSCode风格：暗色主题代码编辑器，支持语法高亮

3. **键盘打字演示**
   - 通过键盘输入逐字符显示内容
   - 实时字符统计

### 新增功能 (2025-10-28)

#### 1. 自动打字机效果 ⭐
- **播放按钮**：自动按设定速度逐字符显示文本
- **暂停按钮**：暂停自动播放
- **智能控制**：播放完成自动停止并提示
- **状态反馈**：按钮状态根据播放状态动态变化

#### 2. 速度控制 🎚️
- **速度滑块**：1-200 级速度调节
- **实时更新**：速度值实时显示
- **动态应用**：播放中修改速度即时生效

#### 3. 进度控制 📊
- **可视化进度条**：绿色渐变进度显示
- **百分比显示**：实时显示演示进度
- **点击跳转**：点击进度条任意位置快速定位
- **重置功能**：一键回到开始位置
- **显示全部**：立即显示所有内容

#### 4. 文件历史记录 📚
- **自动保存**：导入的文件自动保存到历史
- **容量限制**：最多保存10个最近文件
- **持久化存储**：使用 localStorage 保存，刷新不丢失
- **快速加载**：点击历史项快速重新加载
- **时间显示**：显示文件导入时间（刚刚、N分钟前、N小时前）
- **删除功能**：可单独删除历史记录
- **展开/收起**：节省屏幕空间

#### 5. 文件替换功能 📝
- **智能替换**：点击"文件"菜单替换当前文件
- **保留进度**：替换时保留当前显示的字符数量
  - 例如：替换前显示了100字符，替换后也显示前100字符
  - 如果新文件更短，则显示全部内容
- **双界面支持**：Word和VSCode风格均可使用

#### 6. 编辑模式 ✏️
- **实时编辑**：点击"编辑"菜单进入/退出编辑模式
- **直接修改**：编辑模式下可以像正常文本编辑器一样修改内容
- **可视化反馈**：编辑模式下显示蓝色（VSCode）或浅蓝色（Word）边框
- **自动保存**：退出编辑模式时自动保存修改
- **双界面支持**：
  - Word风格：段落式编辑，支持多段落
  - VSCode风格：代码编辑，纯文本模式
- **智能状态**：编辑模式下自动暂停播放和键盘演示

## 项目结构

```
.
├── PresentationMagicTool/        # 前端网页应用
│   ├── index.html                # 主页面
│   ├── styles.css                # 样式文件
│   ├── script.js                 # JavaScript 逻辑
│   └── test.txt                  # 测试文件
├── project/                      # C++ 桌面版本（未使用）
├── server.py                     # Python HTTP 服务器
└── replit.md                     # 项目文档

```

## 使用说明

### 启动应用
应用已配置为自动启动，访问预览窗口即可使用。

### 基本操作
1. **导入文件**：点击左侧边栏"📁 导入文本文件"，选择文件
2. **切换风格**：点击"📄 Word风格"或"💻 VSCode风格"
3. **自动演示**：
   - 导入文件后，点击"▶️ 播放"开始自动演示
   - 使用速度滑块调节播放速度
   - 点击"⏸️ 暂停"暂停播放
   - 点击"🔄 重置"回到开始
   - 点击"📄 全部"立即显示全部内容
4. **查看历史**：点击"📚 最近文件"展开历史记录面板

### 键盘打字模式
除了自动播放，还可以通过键盘逐字符输入：
- 任意字符键：显示下一个字符
- Backspace：退回上一个字符
- Enter：显示下一个字符

## 设计特点

### 用户界面
- **现代化设计**：紫色渐变主题
- **毛玻璃效果**：控制面板采用半透明设计
- **响应式布局**：适配不同屏幕尺寸
- **动画效果**：平滑的过渡和悬停效果

### 用户体验
- **智能按钮状态**：根据当前状态自动禁用/启用按钮
- **即时反馈**：通知提示用户操作结果
- **进度可视化**：清晰显示演示进度
- **历史管理**：方便快速切换不同文件

### 技术亮点
1. **性能优化**
   - 语法高亮缓存机制
   - 按需更新DOM
   - 智能节流

2. **错误处理**
   - localStorage 异常捕获
   - 文件读取错误处理
   - 语法高亮失败回退

3. **代码质量**
   - 模块化函数设计
   - 清晰的注释
   - 一致的命名规范

## 配置说明

### 服务器配置
- **端口**：5000
- **主机**：0.0.0.0（允许所有主机访问）
- **缓存控制**：禁用缓存，确保更新即时生效

### 浏览器存储
- 文件历史记录存储在 localStorage 的 `fileHistory` 键下
- 最多存储 10 个文件记录
- 每个记录包含：文件名、内容、文件类型、时间戳

## 支持的文件类型

### 编程语言
- JavaScript (.js), TypeScript (.ts)
- Python (.py)
- C++ (.cpp), C (.c)
- Java (.java)
- HTML (.html), CSS (.css)
- 等 20+ 种语言

### 文档格式
- Markdown (.md)
- 纯文本 (.txt)
- JSON (.json)
- XML (.xml)
- CSV (.csv)

## 未来改进建议

### 短期优化
- [ ] 添加全屏模式
- [ ] 支持导出演示为视频
- [ ] 添加更多主题选择
- [ ] 字体大小调节

### 长期规划
- [ ] 支持 PDF 文件导入
- [ ] 添加代码执行功能
- [ ] 多人协作演示
- [ ] 云端存储支持

## 开发团队
- 张宇杰
- 俞乐遂
- 田赞尧
- 范佳润

## 许可证
MIT License

## 更新日志

### v2.1.0 (2025-10-28)
- ✨ 新增文件替换功能（保留演示进度）
- ✨ 新增编辑模式（可直接修改文本）
- 🐛 修复VSCode滚动问题（添加min-height: 0到flex链）
- 🎨 添加40vh底部空白，提升阅读体验

### v2.0.0 (2025-10-28)
- ✨ 新增自动打字机效果
- ✨ 新增速度控制滑块
- ✨ 新增可视化进度条和进度控制
- ✨ 新增文件历史记录功能
- 🎨 优化控制面板UI设计
- 🐛 修复缓存问题

### v1.0.0 (2023)
- 🎉 初始版本发布
- ✨ 文件导入功能
- ✨ Word/VSCode 双界面风格
- ✨ 键盘打字演示
- ✨ 语法高亮支持
